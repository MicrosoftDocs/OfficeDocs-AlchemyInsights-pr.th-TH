---
title: ปัญหาเกี่ยวกับโทเค็น
ms.author: v-smandalika
author: v-smandalika
manager: dansimp
ms.date: 01/15/2021
ms.audience: Admin
ms.topic: article
ms.service: o365-administration
ROBOTS: NOINDEX, NOFOLLOW
localization_priority: Priority
ms.collection: Adm_O365
ms.custom:
- "7774"
- "9004351"
ms.openlocfilehash: 14a9681c08920094813497e7a75eb87bb0733cbc
ms.sourcegitcommit: e378232f4c9ef4e962208100db752221e7bd2dd6
ms.translationtype: MT
ms.contentlocale: th-TH
ms.lasthandoff: 01/20/2021
ms.locfileid: "49917216"
---
# <a name="issues-with-tokens"></a><span data-ttu-id="e5a20-102">ปัญหาเกี่ยวกับโทเค็น</span><span class="sxs-lookup"><span data-stu-id="e5a20-102">Issues with tokens</span></span>

<span data-ttu-id="e5a20-103">เมื่อต้องการจัดการปัญหาที่เกี่ยวข้องกับโทเค็นคุณสามารถทำตามขั้นตอนต่อไปนี้:</span><span class="sxs-lookup"><span data-stu-id="e5a20-103">To manage issues related to tokens, you can perform the following steps:</span></span>

1. <span data-ttu-id="e5a20-104">คุณสามารถระบุอายุการใช้งานของการเข้าถึง ID หรือโทเค็น SAML ที่ออกโดยแพลตฟอร์มข้อมูลประจำตัวของไมโครซอฟท์</span><span class="sxs-lookup"><span data-stu-id="e5a20-104">You can specify the lifetime of an access, ID, or SAML token issued by Microsoft identity platform.</span></span> <span data-ttu-id="e5a20-105">คุณสามารถตั้งค่าการหมดอายุของโทเค็นสำหรับแอปทั้งหมดในองค์กรของคุณสำหรับแอปพลิเคชันแบบหลายผู้เช่า (หลายองค์กร) หรือสำหรับบริการหลักที่เฉพาะเจาะจงในองค์กรของคุณ</span><span class="sxs-lookup"><span data-stu-id="e5a20-105">You can set token lifetimes for all apps in your organization, for a multi-tenant (multi-organization) application, or for a specific service principal in your organization.</span></span> <span data-ttu-id="e5a20-106">สำหรับข้อมูลเพิ่มเติมให้ดูที่การกำหนดค่าของ[โทเค็นที่กำหนดค่าไว้ใน Microsoft identity platform (ตัวอย่าง)](https://docs.microsoft.com/azure/active-directory/develop/active-directory-configurable-token-lifetimes)</span><span class="sxs-lookup"><span data-stu-id="e5a20-106">For more information, see [Configurable token lifetimes in Microsoft identity platform (preview)](https://docs.microsoft.com/azure/active-directory/develop/active-directory-configurable-token-lifetimes).</span></span>
2. <span data-ttu-id="e5a20-107">โทเค็นการเข้าถึงจะเปิดใช้งานไคลเอ็นต์ในการโทรที่มีการป้องกันเว็บ APIs อย่างปลอดภัยและใช้งานเว็บ APIs เพื่อดำเนินการรับรองความถูกต้องและการอนุญาต</span><span class="sxs-lookup"><span data-stu-id="e5a20-107">Access tokens enable clients to securely call protected web APIs, and are used by web APIs to perform authentication and authorization.</span></span> <span data-ttu-id="e5a20-108">ตามข้อกำหนดของ OAuth โทเค็นการเข้าถึงจะเป็นสตริงตัวทึบโดยไม่มีรูปแบบชุด-ผู้ให้บริการข้อมูลเฉพาะตัว (IDPs) ใช้ Guid ที่ผู้ใช้อื่นใช้งาน blobs ที่เข้ารหัสลับ</span><span class="sxs-lookup"><span data-stu-id="e5a20-108">As per the OAuth specification, access tokens are opaque strings without a set format - some identity providers (IDPs) use GUIDs, others use encrypted blobs.</span></span> <span data-ttu-id="e5a20-109">แพลตฟอร์มสำหรับข้อมูลเฉพาะตัวของ Microsoft ใช้รูปแบบโทเค็นการเข้าถึงที่หลากหลายขึ้นอยู่กับการกำหนดค่าของ API ที่ยอมรับโทเค็น</span><span class="sxs-lookup"><span data-stu-id="e5a20-109">The Microsoft identity platform uses a variety of access token formats, depending on the configuration of the API that accepts the token.</span></span> <span data-ttu-id="e5a20-110">เมื่อต้องการเรียนรู้วิธีที่ API ของคุณสามารถตรวจสอบและใช้การอ้างสิทธิ์ภายในโทเค็นการเข้าถึงให้ดูที่[โทเค็นการเข้าถึงแพลตฟอร์มสำหรับข้อมูลประจำตัวของไมโครซอฟท์](https://docs.microsoft.com/azure/active-directory/develop/userinfo#calling-the-userinfo-endpoint)</span><span class="sxs-lookup"><span data-stu-id="e5a20-110">To learn how your API can validate and use the claims inside an access token, see [Microsoft identity platform access tokens](https://docs.microsoft.com/azure/active-directory/develop/userinfo#calling-the-userinfo-endpoint).</span></span>
3. <span data-ttu-id="e5a20-111">ไลบรารีการรับรองความถูกต้องของ Microsoft (MSAL) สนับสนุนการทำงานของการรับรองความถูกต้องหลายขั้นตอนในการใช้งานในสถานการณ์สมมติ</span><span class="sxs-lookup"><span data-stu-id="e5a20-111">The Microsoft Authentication Library (MSAL) supports several authentication flows for use in different application scenarios.</span></span> <span data-ttu-id="e5a20-112">สำหรับข้อมูลเพิ่มเติมให้ดูที่[ขั้นตอนการรับรองความถูกต้อง](https://docs.microsoft.com/azure/active-directory/develop/msal-authentication-flows#how-each-flow-emits-tokens-and-codes)</span><span class="sxs-lookup"><span data-stu-id="e5a20-112">For more information, see [Authentication flows](https://docs.microsoft.com/azure/active-directory/develop/msal-authentication-flows#how-each-flow-emits-tokens-and-codes).</span></span>
4. <span data-ttu-id="e5a20-113">คุณสามารถใช้รหัสการตรวจสอบสิทธิ์ของ OAuth ๒.๐ในแอปที่ติดตั้งบนอุปกรณ์เพื่อเข้าถึงทรัพยากรที่มีการป้องกันเช่นเว็บ APIs</span><span class="sxs-lookup"><span data-stu-id="e5a20-113">The OAuth 2.0 authorization code grant can be used in apps that are installed on a device to gain access to protected resources, such as web APIs.</span></span> <span data-ttu-id="e5a20-114">การใช้ Microsoft identity platform การใช้งานของ OAuth ๒.๐คุณสามารถเพิ่มการเข้าสู่ระบบและการเข้าถึง API ไปยังแอปสำหรับอุปกรณ์เคลื่อนที่และเดสก์ท็อปของคุณได้</span><span class="sxs-lookup"><span data-stu-id="e5a20-114">Using the Microsoft identity platform implementation of OAuth 2.0, you can add sign-in and API access to your mobile and desktop apps.</span></span> <span data-ttu-id="e5a20-115">ให้ดูที่ [แพลตฟอร์มสำหรับข้อมูลประจำตัวของ Microsoft และการรับส่งข้อมูลรหัสการตรวจสอบ OAuth ๒.๐](https://docs.microsoft.com/azure/active-directory/develop/v2-oauth2-auth-code-flow#refresh-the-access-token) สำหรับวิธีการทำงานของโปรแกรมโดยตรงกับโพรโทคอลในแอปพลิเคชันของคุณโดยใช้ภาษาใดๆ</span><span class="sxs-lookup"><span data-stu-id="e5a20-115">See [Microsoft identity platform and OAuth 2.0 authorization code flow](https://docs.microsoft.com/azure/active-directory/develop/v2-oauth2-auth-code-flow#refresh-the-access-token) for how to program directly against the protocol in your application, using any language.</span></span>
5. <span data-ttu-id="e5a20-116">OpenID Connect (OIDC) เป็นโพรโทคอลการรับรองความถูกต้องที่สร้างขึ้นบน OAuth ๒.๐ที่คุณสามารถใช้เพื่อลงชื่อเข้าใช้ในแอปพลิเคชันได้อย่างปลอดภัย</span><span class="sxs-lookup"><span data-stu-id="e5a20-116">OpenID Connect (OIDC) is an authentication protocol built on OAuth 2.0 that you can use to securely sign in a user to an application.</span></span> <span data-ttu-id="e5a20-117">เมื่อคุณใช้ Microsoft identity platform ของจุดสิ้นสุดการดำเนินการของ OpenID การเชื่อมต่อคุณสามารถเพิ่มการเข้าสู่ระบบและการเข้าถึง API ของคุณไปยังแอปของคุณได้</span><span class="sxs-lookup"><span data-stu-id="e5a20-117">When you use the Microsoft identity platform endpoint's implementation of OpenID Connect, you can add sign-in and API access to your apps.</span></span> <span data-ttu-id="e5a20-118">[Microsoft identity platform และโพรโทคอลการเชื่อมต่อ OpenID](https://docs.microsoft.com/azure/active-directory/develop/v2-protocols-oidc#send-the-sign-in-request) จะแสดงวิธีการทำงานที่ไม่ขึ้นกับภาษาและอธิบายวิธีการส่งและรับข้อความ HTTP โดยไม่ต้องใช้ไลบรารีแหล่งข้อมูลที่เปิดอยู่ของ microsoft</span><span class="sxs-lookup"><span data-stu-id="e5a20-118">[Microsoft identity platform and OpenID Connect protocol](https://docs.microsoft.com/azure/active-directory/develop/v2-protocols-oidc#send-the-sign-in-request) shows how to do this independent of language and describes how to send and receive HTTP messages without using any Microsoft open-source libraries.</span></span>
    - <span data-ttu-id="e5a20-119">จุดสิ้นสุดของ UserInfo เป็นส่วนหนึ่งของมาตรฐาน OIDC ที่ได้รับการออกแบบมาเพื่อส่งกลับการอ้างสิทธิ์เกี่ยวกับผู้ใช้ที่ได้รับการรับรองความถูกต้อง</span><span class="sxs-lookup"><span data-stu-id="e5a20-119">The UserInfo endpoint is part of the OIDC standard, designed to return claims about the user that authenticated.</span></span> <span data-ttu-id="e5a20-120">สำหรับข้อมูลเพิ่มเติมให้ดูที่จุดสิ้นสุดของ[Microsoft identity Platform UserInfo](https://docs.microsoft.com/azure/active-directory/develop/userinfo#consider-use-an-id-token-instead)</span><span class="sxs-lookup"><span data-stu-id="e5a20-120">For more information, see [Microsoft identity platform UserInfo endpoint](https://docs.microsoft.com/azure/active-directory/develop/userinfo#consider-use-an-id-token-instead).</span></span>
    - <span data-ttu-id="e5a20-121">การ [โทรผ่านเว็บ API ในเว็บแอปโดยใช้ AZURE ad และ OpenID Connect](https://docs.microsoft.com/samples/azure-samples/active-directory-dotnet-webapp-webapi-openidconnect/active-directory-dotnet-webapp-webapi-openidconnect/) จะแสดงวิธีการสร้างแอปพลิเคชัน MVC บนเว็บที่ใช้ azure AD สำหรับการลงชื่อเข้าใช้โดยใช้การเชื่อมต่อโพรโทคอล OpenID แล้วโทรผ่านเว็บ API ภายใต้ข้อมูลเฉพาะตัวของผู้ใช้ที่ลงชื่อเข้าใช้โดยใช้โทเค็น๒.๐</span><span class="sxs-lookup"><span data-stu-id="e5a20-121">The [Calling a web API in a web app using Azure AD and OpenID Connect](https://docs.microsoft.com/samples/azure-samples/active-directory-dotnet-webapp-webapi-openidconnect/active-directory-dotnet-webapp-webapi-openidconnect/) sample shows how to build an MVC web application that uses Azure AD for sign-in using the OpenID Connect protocol, and then call a web API under the signed-in user's identity using tokens obtained via OAuth 2.0.</span></span> <span data-ttu-id="e5a20-122">ตัวอย่างนี้ใช้ OpenID เชื่อมต่อ ASP .Net OWIN และ ADAL .Net</span><span class="sxs-lookup"><span data-stu-id="e5a20-122">This sample uses the OpenID Connect ASP .Net OWIN middleware and ADAL .Net.</span></span>
6. <span data-ttu-id="e5a20-123">[กำหนดค่าแอปพลิเคชันเพื่อแสดงเว็บ api](https://docs.microsoft.com/azure/active-directory/develop/quickstart-configure-app-expose-web-apis) -ใน quickstart นี้คุณจะลงทะเบียนเว็บ Api ด้วย Microsoft identity platform และแสดงแอปพลิเคชันไคลเอ็นต์โดยการเพิ่มขอบเขตตัวอย่าง</span><span class="sxs-lookup"><span data-stu-id="e5a20-123">[Configure an application to expose a web API](https://docs.microsoft.com/azure/active-directory/develop/quickstart-configure-app-expose-web-apis) - In this quickstart, you register a web API with the Microsoft identity platform and expose it to client apps by adding an example scope.</span></span> <span data-ttu-id="e5a20-124">ด้วยการลงทะเบียนเว็บ API ของคุณและเปิดเผยข้อมูลผ่านขอบเขตคุณสามารถให้สิทธิ์การเข้าถึงทรัพยากรของผู้ใช้ที่ได้รับอนุญาตและแอปพลิเคชันไคลเอ็นต์ที่เข้าถึง API ของคุณได้</span><span class="sxs-lookup"><span data-stu-id="e5a20-124">By registering your web API and exposing it through scopes, you can provide permissions-based access to its resources to authorized users and client apps that access your API.</span></span>
7. <span data-ttu-id="e5a20-125">ใน Azure Active Directory B2C (Azure AD B2C) การไหลของเจ้าของทรัพยากรข้อมูลประจำตัว (ROPC) คือการไหลของการรับรองความถูกต้องของมาตรฐาน OAuth</span><span class="sxs-lookup"><span data-stu-id="e5a20-125">In Azure Active Directory B2C (Azure AD B2C), the resource owner password credentials (ROPC) flow is an OAuth standard authentication flow.</span></span> <span data-ttu-id="e5a20-126">ในขั้นตอนนี้แอปพลิเคชันหรือที่เรียกอีกอย่างว่าบริษัท relying ให้แลกเปลี่ยนข้อมูลประจำตัวที่ถูกต้องสำหรับโทเค็น</span><span class="sxs-lookup"><span data-stu-id="e5a20-126">In this flow, an application, also known as the relying party, exchanges valid credentials for tokens.</span></span> <span data-ttu-id="e5a20-127">ข้อมูลประจำตัวมี ID ผู้ใช้และรหัสผ่าน</span><span class="sxs-lookup"><span data-stu-id="e5a20-127">The credentials include a user ID and password.</span></span> <span data-ttu-id="e5a20-128">โทเค็นที่ส่งกลับเป็นโทเค็น ID โทเค็นการเข้าถึงและโทเค็นการรีเฟรช</span><span class="sxs-lookup"><span data-stu-id="e5a20-128">The tokens returned are an ID token, access token, and a refresh token.</span></span> <span data-ttu-id="e5a20-129">สำหรับข้อมูลเพิ่มเติมให้ดู [ที่การตั้งค่าการไหลของข้อมูลประจำตัวของเจ้าของทรัพยากรใน B2C Azure active](https://docs.microsoft.com/azure/active-directory-b2c/add-ropc-policy?tabs=app-reg-ga&pivots=b2c-user-flow)directory</span><span class="sxs-lookup"><span data-stu-id="e5a20-129">For more information, see [Set up a resource owner password credentials flow in Azure Active Directory B2C](https://docs.microsoft.com/azure/active-directory-b2c/add-ropc-policy?tabs=app-reg-ga&pivots=b2c-user-flow).</span></span> 

